<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
  </head>

  <body>
    <script>
      "use strict";

      /* В задании требуется решить, какую структуру данных можно
    использовать для ответа на вопрос «было ли сообщение прочитано? 
    При решении этой задачи у меня возник вопрос, кем прочитано? 
    Если это касается меня, то ответ прост, создаем собственную 
    коллекцию new WeakSet(), в которую помещаем все прочитанные 
    сообщения, а в качестве ключей используем сами объекты
    сообщений. Почему, именно, new WeakSet()? Во-первых, потому, 
    что WeakSet лучше подходит для структур данных типа "да/нет". 
    Во-вторых, данные из коллекции WeakSet будут автоматически 
    удаляться при удалении сообщений в исходном массиве. */

      // Итак, существует некий массив с сообщениями
      let messages = [
        { text: "Hello", from: "John" },
        { text: "How goes?", from: "John" },
        { text: "See you soon", from: "Alice" },
      ];

      // Создаем собственную коллекцию для учета прочитанных сообщений
      const readMessages = new WeakSet();

      // Читаем сообщение
      alert(
        `Это сообщение от ${messages[1].from}, в котором содержится следующее: \n${messages[1].text}`
      );

      // Прочитанное сообщение помещаем в коллекцию
      readMessages.add(messages[1]);

      // В любой момент можно узнать, было ли сообщение прочитано
      let num = prompt("Введите номер сообщения от 1 до 3", "");
      let isReadMessage = readMessages.has(messages[num - 1]); // если num === 2, то true

      isReadMessage
        ? alert("Это сообщение вами уже прочитано")
        : alert("Это сообщение вы еще не читали");

      /* Если кто-то удалит это сообщение в массиве messages, например:
    messages.splice(1, 1);
    то объект { text: "How goes?", from: "John" }, будет удален. 
    А так как в нашей коллекции в качестве ключа используется этот 
    объект, то и здесь он будет автоматически удален. */

      /* Даже если наше прочитанное сообщение изменит положение в
    массиве messages, например, при удалении сообщения
    { text: "Hello", from: "John" }: */
      messages.splice(0, 1);

      // мы если встретим наше прочитанное сообщение
      // по новому индексу, то сможем узнать, что мы его читали:
      alert(readMessages.has(messages[0])); // true
    </script>
  </body>
</html>
